<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Xcalar-List</title>
<link href="cat_photoshop.css" rel="stylesheet" type="text/css">
<style type="text/css">
body,td,th {
	font-family: "Arial Century Schoolbook L", "Times New Roman", serif;
}
body {
	background-color: #f5f5f5;
}
</style>
<script src="script.js"></script>
<script src="js/thrift.js" type="text/javascript"></script>
<script src="js/Status_types.js" type="text/javascript"></script>
<script src="js/libapis_common_types.js" type="text/javascript"></script>
<script src="js/XcalarApiService.js" type="text/javascript"></script>
<script>
    $(document).ready(function(){
        $('table.XcalarApiService').attr('width', 500);
    });

    function XcalarGetCount() {
        var transport = new Thrift.Transport(
                "http://192.168.1.34:9090/thrift/service/XcalarApiService/");
        var protocol = new Thrift.Protocol(transport);
        var client = new XcalarApiServiceClient(protocol);

        var workItem = new XcalarApiWorkItemT();
        workItem.apiVersion = 0;
        workItem.api = XcalarApisT.XcalarApiCountUnique;
        workItem.input = new XcalarApiInputT();
        workItem.input.countInput = new XcalarApiCountInputT();
        workItem.input.countInput.table = new XcalarApiTableT();
        workItem.input.countInput.table.tableName = $('#GetCountTableName').val();
        workItem.input.countInput.table.handle = 0;

        try {
            result = client.queueWork(workItem);
            $('#GetCountStatus').val(result.output.countOutput.status);
            $('#GetCountNum').val(result.output.countOutput.numCounts);
            $('#GetCount0').val(result.output.countOutput.counts[0]);

            $('#GetCountStatus').css('color', 'black');
            $('#GetCountNum').css('color', 'black');
            $('#GetCount0').css('color', 'black');
        } catch(ouch) {
            $('#GetCountStatus').val(ouch.status);
            $('#GetCountStatus').css('color', 'red');
        }
    }

    function XcalarGetNumTables() {
        var transport = new Thrift.Transport("http://192.168.1.34:9090/thrift/service/XcalarApiService/");
        var protocol = new Thrift.Protocol(transport);
        var client = new XcalarApiServiceClient(protocol);

        var workItem = new XcalarApiWorkItemT();
        workItem.apiVersion = 0;
        workItem.api = XcalarApisT.XcalarApiListTables;

        try {
            result = client.queueWork(workItem);
            return (result.output.listOutput.numTables);
        } catch(ouch) {
            return -1;
        }
    }

    function XcalarGetTableNames() {
        var transport = new Thrift.Transport("http://192.168.1.34:9090/thrift/service/XcalarApiService/");
        var protocol = new Thrift.Protocol(transport);
        var client = new XcalarApiServiceClient(protocol);

        var workItem = new XcalarApiWorkItemT();
        workItem.apiVersion = 0;
        workItem.api = XcalarApisT.XcalarApiListTables;

        try {
            result = client.queueWork(workItem);
            return (result.output.listOutput);
        } catch(ouch) {
            return "";
        }
    }

    </script>
</head>

<body topmargin="0" leftmargin="0">
<table width="100%" border="0" class="stbg"
    id="autoGenTable" cellspacing="1px" cellpadding="2px">
  <tr>
    <td width="3%" height="17" class="table_title_bg" id="headCol1"><strong>ID</strong></td>
    <td height="17" class="table_title_bg" id="headCol2"><strong>Value</strong></td>
  </tr>
    <script>
        
        //$("#autoGenTable").bind('selectstart', function(event) {
        //    event.preventDefault();
        //});
        var numTables = XcalarGetNumTables();
        var tables = XcalarGetTableNames();
        var i;
        for (i = 0; i<numTables; i++) {
            var t = tables.tables[i];
            generateRowWithAutoIndex(t.tableName);
	    }
        $(document).on('dblclick', '.table_title_bg', function(event) {
            addCol($(this).attr("id"));
        });
    </script>
</table>
</body>
</html>

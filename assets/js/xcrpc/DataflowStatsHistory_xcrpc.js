// **********************************************************************
// *** DO NOT EDIT!  This file was autogenerated by xcrpc             ***
// **********************************************************************
// Copyright 2018 Xcalar, Inc. All rights reserved.
//
// No use, or distribution, of this source code is permitted in any form or
// means without a valid, written license agreement with Xcalar, Inc.
// Please refer to the included "COPYING" file for terms and conditions
// regarding the use and redistribution of this software.
//

var client = require("./Client");
var service = require('./xcalar/compute/localtypes/Service_pb');

var dataflowStatsHistory = require("./xcalar/compute/localtypes/DataflowStatsHistory_pb");


////////////////////////////////////////////////////////////////////////////////
// Constructors
////////////////////////////////////////////////////////////////////////////////

function DataflowStatsHistoryService(client) {
    this.client = client;
}

////////////////////////////////////////////////////////////////////////////////
// Definitions
////////////////////////////////////////////////////////////////////////////////

DataflowStatsHistoryService.prototype = {
    listJobs: async function(listJobsRequest) {
        // XXX we want to use Any.pack() here, but it is only available
        // in protobuf 3.2
        // https://github.com/google/protobuf/issues/2612#issuecomment-274567411
        var anyWrapper = new proto.google.protobuf.Any();
        anyWrapper.setValue(listJobsRequest.serializeBinary());
        anyWrapper.setTypeUrl("type.googleapis.com/xcalar.compute.localtypes.DataflowStatsHistory.ListJobsRequest");
        //anyWrapper.pack(listJobsRequest.serializeBinary(), "ListJobsRequest");
        try {
            var responseData = this.client.execute("DataflowStatsHistory", "ListJobs", anyWrapper)
            var specificBytes = responseData.getValue();
                // XXX Any.unpack() is only available in protobuf 3.2; see above
                //var listJobsResponse =
                //    responseData.unpack(dataflowStatsHistory.ListJobsResponse.deserializeBinary,
                //                        "ListJobsResponse");
            var listJobsResponse = dataflowStatsHistory.ListJobsResponse.deserializeBinary(specificBytes);
            return listJobsResponse;

        } catch(error) {
            console.log("listJobs fail:" + JSON.stringify(error));
            throw error;
        }
    },
    getStatsForJob: async function(jobStatsRequest) {
        // XXX we want to use Any.pack() here, but it is only available
        // in protobuf 3.2
        // https://github.com/google/protobuf/issues/2612#issuecomment-274567411
        var anyWrapper = new proto.google.protobuf.Any();
        anyWrapper.setValue(jobStatsRequest.serializeBinary());
        anyWrapper.setTypeUrl("type.googleapis.com/xcalar.compute.localtypes.DataflowStatsHistory.JobStatsRequest");
        //anyWrapper.pack(jobStatsRequest.serializeBinary(), "JobStatsRequest");

        try {
            var responseData = this.client.execute("DataflowStatsHistory", "GetStatsForJob", anyWrapper)

            var specificBytes = responseData.getValue();
            // XXX Any.unpack() is only available in protobuf 3.2; see above
            //var jobStatsResponse =
            //    responseData.unpack(dataflowStatsHistory.JobStatsResponse.deserializeBinary,
            //                        "JobStatsResponse");
            var jobStatsResponse = dataflowStatsHistory.JobStatsResponse.deserializeBinary(specificBytes);
            return jobStatsResponse;
        } catch(error) {
            console.log("getStatsForJob fail:" + JSON.stringify(error));
        }
    },
};

exports.DataflowStatsHistoryService = DataflowStatsHistoryService;

#!/bin/bash

echo "// This file is auto-generated by MAC.sh or RUNME.SH" > prod/assets/js/setup/constructorVersion.js
echo "var gBuildNumber = '"${BUILD_NUMBER}"';" >> prod/assets/js/setup/constructorVersion.js
echo -n "var gConstructorVersion = '" >> prod/assets/js/setup/constructorVersion.js

OS=`uname`
if [ "${OS}" = "Darwin" ]; then
    echo -n `md5 prod/assets/js/setup/constructor.js | cut -d' ' -f4` >> prod/assets/js/setup/constructorVersion.js
else
    echo -n `md5sum prod/assets/js/setup/constructor.js | cut -d' ' -f4` >> prod/assets/js/setup/constructorVersion.js
fi
echo "';" >> prod/assets/js/setup/constructorVersion.js
echo -n "var gGitVersion = '" >> prod/assets/js/setup/constructorVersion.js
echo -n `git log --pretty=oneline --abbrev-commit -1 | cut -d' ' -f1` >> prod/assets/js/setup/constructorVersion.js
echo "';" >> prod/assets/js/setup/constructorVersion.js
